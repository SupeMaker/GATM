# coding=utf-8
import re
#
# doc =  """Trying to Make a Ram 3500 as Quick as a Viper Requires Some Disassembly
#       Some blasphemy was involved in going to work on an $87,00 2019 Ram 3500 with wrenches and pliers. Track workers looked on with amusement and concern as we pulled the truck down to its skeletal self. Piles of brand-new, metallic-red sheetmetal and deep-black leather were strewn out under a cloudy central California sky a few feet from Auto Club Famoso Raceway’s quarter-mile. If you’re wondering what fueled the explosion of coal-rolling, lifted diesel pickups over the past few years, take a good look at this truck. Ram will now sell you a pickup with 400 hp and 1000 lb-ft of torque in factory trim. One thousand. That number can only be bested by the likes of the Bugatti Chiron, and it is part of the recipe that lets the truck tow up to 31,500 pounds. That’s seven Chirons and their well-moneyed occupants. It’s also far in excess of what you can legally lug behind a truck without a commercial driver’s license in most states. That’s 26,000 pounds, truck and trailer combined weight. The really crazy part? The diesel aftermarket has been hitting those power numbers with simple ECU reflashes for decades. The only difference is that the 2019 Ram does it with a factory warranty and without spewing clouds of black smoke. It’s not Lamborghinis that fill the heads of our nation’s farmland youth. It’s the new Cummins. This machine may be the poster child for capability creep, a perfect example of our age’s obsession with progress. The Ram is also a stunning piece of engineering, a tow rig that’s just as fascinating as anything you’d throw on the trailer behind it. Looking at its spec sheet got us thinking about another moonshot Chrysler: the first generation Viper. Its 8.0-liter V-10 managed 400 hp and 450 lb-ft of torque when it debuted in 1991, figures that were good enough to rip the car down the quarter-mile in 12.9 seconds. The Ram’s 6.7-liter I-6 turbodiesel Cummins engine puts the Viper’s power numbers in the dirt, but what about that last bit? Could we get this massive, one-ton pickup down the drag strip as quickly as a Viper without doing anything under the hood? This was a dumb question made dumber by the truck at hand: a four-wheel-drive, four-door, long-bed dualie loaded with every option, including five onboard cameras, a massive tombstone infotainment screen, and a factory fifth-wheel hitch. At more than 8500 pounds, the big Ram carries more mass than two Vipers. But, hey, you hit with the fists you’ve got, not the ones you wish you had. If any engine is up to the task, it’s this one. Cummins is a company synonymous with immortal engines, workhorses unfazed by neglect or abuse, capable of mind-boggling power and longevity. It’s not uncommon to see an old 5.9 still rattling away with more than 400,000 miles on the odometer, a thumb in the eye of anyone who’s ever cast a sidelong glance at a Chrysler. Where most truck owners afford their chosen brand the kind of loyalty reserved for mothers and other deities, a Cummins gets respect from everyone, regardless of the keys in their pocket. “Hell of a motor” is the usual refrain. The take rate is insane. Of all heavy-duty Rams that roll off the showroom floor, 80 percent leave with a Cummins badge on the fender. Years ago, when the company unveiled its 850-lb-ft max-tow powerplant, I cornered an engineer. I wanted to know if they were getting close to some sort of power ceiling, if the engine’s architecture could take much more. The guy looked at me like I’d asked him if the sun was made of cheese. “No,” he laughed. “When they build a transmission that can stand up to what we can produce, we’ll have the power for them.” That was the old 6.7-liter straight-six. This engine is something new. Cummins abandoned the cast-iron block in favor of compacted graphite iron, which is lighter and 75 percent stronger than the old material. That pulled 60 pounds from the engine and allows the big six to withstand higher cylinder pressures. Good thing, as there’s a new variable-geometry Holset/Cummins turbo bolted to the manifold that shoves 33 psi down the engine’s throat. There’s a new crank and forged rods to help deal with the extra boost, and the redesigned cast-iron cylinder head has hydraulic lifters for the first time. Ram’s been on a long quest to civilize its big diesel, and now the engine is quiet from behind the wheel, the familiar valvetrain clatter nearly banished. I miss it. That racket was the background to a wild and brilliant year for my family, when we turned a 2003 Dodge Ram 2500 with more than 280,000 miles on it into a camper and lived out of it. If I seem like a Cummins cheerleader, it is because I have seen what the engines are capable of. Over 11 months, we put more than 30,000 miles on that truck, every one of them overloaded, plenty off-road. The engine never blinked. Not scrambling through Big Bend National Park’s Black Gap Road nor pulling itself and a buddy’s derelict Tacoma up Eisenhower Pass at 11,000 feet, the Ram’s boost gauge pegged at 21 psi for 30 minutes straight. Hell of a motor. At Auto Club Famoso, we needed to set a baseline. The track was clean and prepped. The air was cool. I rolled the truck into the burnout box and set the rear wheels spinning. The tach started swinging, accompanied by the vague sensation that something dramatic was unfolding very far away. It was like riding out an earthquake from the next state over. Once in the staging beam, I ramped up the boost and let fly. I don’t know what I expected. All 1000 lb-ft of torque to take a seat on my chest, probably. Instead, it felt slow. First gear was a dog. Chrysler has finally put the manual transmission out to pasture, and your only option for the max-tow package is now an Aisin six-speed automatic. Thrust arrived after second gear, the unladen truck bouncing down the track on its way to a devastating 16.723 seconds at 85.64 mph. Woof. For the first time, it was clear exactly how much power it takes to get this thing moving, to overcome all that weight. We had some work to do. Drag-racing lore says that for every 100 pounds you delete from a vehicle, you gain a tenth of a second in the quarter. By that math, in order to get the Ram down to the Viper’s 12.9-second time, we would have to pull 3820 pounds from the truck. It wasn’t just a tall order, it was outright impossible, but we busted out the tools anyhow, confident in at least one other trick we’d brought as a nuclear option: a set of Hoosier drag radials. First went that fifth-wheel hitch, and when we weighed it on our super accurate Walmart bathroom scales, it came out to 160 pounds by itself. Then went the tonneau cover. The tailgate followed, another 60 pounds. The rear bumper? Thirty more. Then the rear hitch. The spare tire alone was nearly 70 pounds. This was looking good. The thing is, once you start taking parts off of a machine, it’s hard to stop. And for all the changes the brand has brought to the Ram Heavy Duty in the 16 years between my truck and this one, there’s so much that’s the same. The bones beneath that drastically different skin are remarkably similar. I knew how to take the bed off. There are a million wires that run back there, way more than what’s on the older trucks. I know this because they make a distinct sinew-snapping sound when they’re ripped free by five guys in a parking lot. This truck’s owner winced at the sound but was committed to our foolishness. Then went the automatic running boards and doors. Every time we disconnected a wiring harness, the dash dinged in protest. “What are you doing, Dave?” It took this long for me to consider the possibility that the truck might refuse to start after finding itself skinned and gutted. New vehicles are uncomfortably self-aware, but we’d come too far. Out went the seats. It’s hard to say exactly how much weight we removed. The doors were good for around 360 pounds. I’d say we pulled the better part of half a Miata out of the truck. There was a short-circuit in my brain as I approached the opening that was formerly the driver’s door. I found myself reaching for a handle that was lying on the asphalt 10 feet away. Ingress had been significantly improved. I pressed the brake and thumbed the start button, and to my sheer joy, the Cummins fired. Bring on the apocalypse. I am Lord Humongous and this is my War Rig. Bow before my death tractor, ye of Viper Clan. All those precious noises I missed came bouncing off the pavement and into the cabin. That clatter like an old friend, the whoosh of the mammoth turbo. It’d been hours since our first run. The track surface was now stone-cold, but I could still hear the tires sticking to the layers of spent rubber as I rolled into the burnout box once again, the stale-wine smell of the track prep deep in my lungs as the back tires got to spinning. You want to feel fast? Fire a doorless dualie down a drag strip. There was burning rubber in my nose hairs; the wind grabbed at the seatbelts and flung the buckles out of the open cabin, the tires making a ray-gun skeeeeeeeeeeewwww racket as I tripped the beam at more than 90 mph. I was heartbroken as I rolled back to the staging lanes, the lights glowing with a 15.855 in my rearview. We tried a few more runs. First deleting the outer dualie wheels, rationalizing that what we lost in traction we’d make up for in wheel speed. We went slower. Then came my ace: those gorgeous Hoosiers in the tallest size they make. I’d scrounged up a set of cheap steel wheels hoping Ram hadn’t changed the lug pattern on the new axle. Hope in one hand, etc. I nearly cried when the wheels did not fit, our tires lying unsmoked in the pile of parts scattered across the staging lanes. We made one last pass, this time with the spare back in place, praying that the extra weight would lend some needed traction. It didn’t. That was when the first fat raindrops fell on the windshield. A sea of disassembled Ram stared back at me through the glass. Just like that, we were done. With water on the track, our day was over. In the quarter-mile, each second is a lifetime, and there were still three of them between our best run and the first-gen Viper’s published time. I know that in motorsports the steps to each victory are paved with a hundred thousand misses, an encyclopedia of lessons taught by life’s most stern and valuable teacher. This was just one of them. There’s no telling what we could have accomplished with a better driver and those sticky Hoosiers, let alone a lighter truck, but the fact that this mammoth machine can punch its way to a 15-second quarter is a minor miracle, another line in the Cummins legend. It would be hours before we had the truck reassembled and fully functional, thin cold mist falling in sheets into the sparse light cast by one generous street lamp. And while my hands were busy working fasteners and connectors, my mind kept running over the infinite variables that go into something as simple as moving quickly in a straight line for a mere quarter mile. We’d asked this Cummins to do something impossible, something so far beyond the scope of its intended use that in most cases, it wouldn’t be worth trying at all. But this truck and its engine have built an empire on the bones of what shouldn’t be possible. If it can pull 31,500 pounds, slog its way to half a million miles, and tear at the ground with 1000 lb-ft of torque, why shouldn’t it be able to chase down a first-generation Viper? Weight be damned. I’m not convinced we failed so much as made progress toward that 12.9-second quarter, and if another Ram 3500 shows up in my driveway, I’ll put those Hoosiers to use and make a little more."""
#
#
def split_sentences(text):
    # 定义句子结束的标点符号集合
    end_punctuation = r'[。!?\n]'
    # 使用正则表达式按句子切割文本
    sentences = re.split(end_punctuation + ' ', text)
    return sentences
#
# sentences = split_sentences(doc)
# print(sentences)


import torch
from sklearn.metrics.pairwise import cosine_similarity
from transformers import BertTokenizer, BertModel
import networkx as nx
import numpy as np

def bertsum_summarize(text):
    # 加载预训练的BERT模型和tokenizer
    tokenizer = BertTokenizer.from_pretrained('D:\\AI\\model\\bert-base-uncased')
    model = BertModel.from_pretrained('D:\\AI\\model\\bert-base-uncased')
    text = split_sentences(text)
    # 使用BERT tokenizer对文本进行处理
    inputs = tokenizer(text, return_tensors='pt', max_length=512, truncation=True)

    # 获取BERT模型的输出
    with torch.no_grad():
        outputs = model(**inputs)

    # 获取句子的表示
    sentence_embeddings = outputs.last_hidden_state.mean(dim=1)

    # 计算句子之间的余弦相似度矩阵
    similarity_matrix =cosine_similarity(sentence_embeddings, sentence_embeddings)

    # 将相似性矩阵转换为图结构
    nx_graph = nx.from_numpy_array(similarity_matrix)

    # 使用PageRank算法来得到句子排名
    scores = nx.pagerank(nx_graph)

    # 根据得分排序句子
    sorted_indices = sorted(scores, key=scores.get, reverse=True)

    # 选择得分最高的前几个句子作为摘要
    summary_sentences = [tokenizer.decode(inputs['input_ids'][0][idx].tolist()) for idx in sorted_indices[:3]]

    return ' '.join(summary_sentences)

# 示例文本
text = """
在过去的十年中，人工智能取得了巨大的进步。从语音识别到自然语言处理再到计算机视觉，AI技术已经渗透到我们生活的方方面面。BERT是一种深度学习模型，已经证明在各种自然语言处理任务中非常有效。BERTSUM是基于BERT模型的文本摘要方法，它能够自动提取文本中的关键信息并生成简洁的摘要。
"""

# 进行摘要
summary = bertsum_summarize(text)
print(summary)